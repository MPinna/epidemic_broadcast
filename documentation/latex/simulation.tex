%-------------------------------------------------------------------------------
% File: simulation.tex
%       Epidemic Broadcast project documentation.
%
% Author: Marco Pinna, Rambod Rahmani, Yuri Mazzuoli
%         Created on 05/12/2020
%-------------------------------------------------------------------------------
\chapter{Simulation}\label{simulation}
As we previously described, we decided to consider a population of $100$ users
in two different scenarios:
\begin{itemize}
    \item \textbf{Small}: a $10$m x $10$m floorplan, with the transmission
    radius ranging from $1$m to $4.5$m, with a step of $0.5$m, and a Bernullian
    RV with success probability $p$ ranging from $0.05$ to $0.95$ with steps of
    $0.05$;
    \item \textbf{Big}: a $100$m x $100$m floorplan, with the transmission
    radius ranging from $1$m to $19$m, with a step of $1$m, and a Bernoullian RV
    with success probability $p$ ranging from $0.1$ to $0.9$ with steps of $0.1$;
\end{itemize}
In order to achieve statistically significant results with a minimum accuracy of
$90$\%, we decided to repeat the same scenario with the same parameters for
$200$ times, and then computed mean and median values of the performance
indexes, along with their confidence intervals.
\section{Big}\label{big}
\subsection{Coverage}
This plot show the coverage achieved in function of P, for different values of R.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.9}{\import{img}{img/Big_CovP_median.pgf}}
    \end{center}
    \caption{sds}
\end{figure}
As we can observe, the coverage we can reach is maximum when P is low; this was predictable by the fact that a low transmission
probability minimize the number of collisions, increasing the number of correct transmissions. 
The acheiveble coverage decrease with the increasing of p, but this beahveour is quite slow and
dont degenerate to 0, but it land at a value around (XX\%) of the bmaximum. %todo
This shape is common for all the values of the transmission range R, but it's more evident for R$>$10.\\\\
This plot show the coverage achived in function of R, for different values of P.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.9}{\import{img}{img/Big_CovRange_mean.pgf}}
    \end{center}
\end{figure}
As we can expect, and accordingly with the previus plot, the final coverage of the flooplan is very
influenced by the transmission range; in this plot we can observe that the covreage increase exponentially
in respect to the transmission range. When the transmission range become very large ($>20m$),
the coverage tend to 100\%. We recognized the shape of a sigmoid\footnote{https://mathworld.wolfram.com/SigmoidFunction.html} 
which can be express as an hyperbolic tangent ($ \tanh $); this function is always increasing and can be manipulated
to be keeped between 0 and 1 (like the parameter we want to fit). A good fit for this curve is this one:\\
\begin{equation*}
    C =  \frac{1+\tanh(aR+b)}{2} 
\end{equation*} 
with $C$ coverage, $R$ transmission range, $a$ and $b$ depending on $p$ as:\\
%p0.1 0.3628314535334378 4.356732935967713
%p0.2 0.3572920723369711 4.3206795324164835
%p0.3 0.34371134773480694 4.193385575628803
%p0.4 0.3217942874156316 3.9814759531755515
%p0.5 0.3091448275788839 3.88645016495332
%p0.6 0.2809863550485405 3.6000814495973996
%p0.7 0.25932462296148107 3.3996924196436975
%p0.8 0.23603288616377227 3.1648817545125527
%p0.9 0.20917405109220505 2.929033169711656
\\
\subsection{Duration}
This plot show the Duration of the simulation (in slot) in function of P, for different values of R.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.42}{\import{img}{img/Big_DurP_median.pgf}}
    \end{center}
\end{figure}
The simulation needs more slots to complete when P is low; this is a consequence of two factors:
\begin{itemize}
    \item the probability of retransmission is low, so nodes will skip more slots without transmitting;
    \item with less collisions, we can reach more nodes, and we have to wait until they all retrasmit the message once.
\end{itemize}
We try to interpolate those curves with an iperbolic function, because it fits well with the parameters we want to mode;
first of all, the iperbole tends to infinity if P tends to 0, and this is coherent with the reality, because if the probability
of retransmission is become low, the duration keeps increasing. If instead p become close to 1, the duration tends to a minumun.
%compute it? todo
We fit those shapes like this:
\begin{equation*}  
    D =  \frac{a}{P}+b 
\end{equation*}
with $D$ duration of the simulation, $P$ probability of retransmission, $a$ and $b$ depending on $R$ as:\\
%vedi iperbole_parameters.txt, primi due non significativi
PLACEHOLDER\footnote{first two parameters are not possible to compute correctly due to a poor dataset, infact 
if the trasmission range is too short nodes cant really communicate}\\\\
This plot show the Duration of the simulation (in slot) in function of R, for different values of P.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.9}{\import{img}{img/Big_DurRange_mean.pgf}}
    \end{center}
\end{figure}
The duration of the simulation tend to increase with the transmission range reaching a peak around 13m; the maximum value 
depends on the probability of retransmission (p);
This is an intresting result, and can be explained by:?%todo
\subsection{Collisions}
This plot show the Number of collisions in function of P, for different values of R.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.4}{\import{img}{img/Big_CollP_median.pgf}}
    \end{center}
\end{figure}
This plot show the Number of collisions in function of R, for different values of P.
\begin{figure}[H]
    \begin{center}
        \scalebox{0.69}{\import{img}{img/Big_CollRange_mean.pgf}}
    \end{center}
\end{figure}
